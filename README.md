# Predicting Peptide-MHC Binding Affinities With Imputed Training Data

This repository has the data, analysis notebooks, and latex files for [Predicting Peptide-MHC Binding Affinities With Imputed Training Data](http://biorxiv.org/content/early/2016/05/22/054775), submitted to the [ICML 2016 Workshop on Computational Biology](https://sites.google.com/site/compbioworkshopicml2016/).


## Data and notebooks
The predictions on the blind test data generated by the MHCflurry predictors, netMHC, netMHCpan, and SMM are available in [data/validation_predictions_full.csv](blob/master/data/validation_predictions_full.csv). This file has preditions from 64 MHCflurry models, 32 with imputation and 32 without. Descriptions of the models are in [data/validation_models.csv](blob/master/data/validation_models.csv).

The notebook to train the predictors and generate these results took about 20 hours to run on a single TITAN X GPU and is in [notebooks/validation.ipynb](blob/master/notebooks/validation.ipynb).

The analysis of these results, including generating ensemble predictions from the individual predictors and calculating AUC, F1, and tau scores is in [notebooks/validation results analysis.ipynb](blob/master/notebooks/validation%20results%20analysis.ipynb).

The command to generate the data for Figure 1 was:

```
mhcflurry-dataset-size-sensitivity.py \
	--allele HLA-A0201  \
	--training-csv data/bdata.2009.mhci.public.1.txt \
	--imputation-method mice \
	--number-dataset-sizes 15 \
	--random-negative-samples 0 \
	--min-observations-per-peptide 3 \
	--training-epochs 250 \
	--repeat 3 \
	--max-training-samples 500 \
	--min-training-samples 10 \
	--dropout 0.5 \
	--hidden-layer-size 64 \
	--embedding-size 32
```

## Tools versions

We used MHCflurry revision [52a88ace](https://github.com/hammerlab/mhcflurry/tree/52a88ace03ea0bba9c2d366ba63f9e13238c7d22).









