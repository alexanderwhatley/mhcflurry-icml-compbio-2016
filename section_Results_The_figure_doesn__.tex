\section{Results}
\subsection{Imputation}
We first evaluated the effect of imputation, using only the training set, by down-sampling the three alleles with the most training data to a range of simulated training set sizes and testing on the remaining data (Figure ~\ref{fig:imputecomparison}). We find that imputation gives a modest improvement up to approximately 100 training samples, but that with more training data there is no benefit to imputation. The results are similar for the two other performance metrics (not shown).

% The figure doesn't show up in the preview but does show up if you export to pdf.
\begin{figure}[here]
\includegraphics{figures/impute_comparison.pdf}
\caption{MHCFlurry AUC on down-sampled training data with and without imputation}
\label{fig:imputecomparison}
\end{figure}

\subsection{Blind test data}
Using the blind test data, we compared the performance of two MHCFlurry-based models, ``mhcflurry ensemble'' and ``mhcflurry single'' with netMHC, netMHCpan, and smmpmbec. The ``mhcflurry single'' model is one predictor with the architecture described previously. The ``MHCFlurry ensemble`` model is an ensemble of 10 predictors, all identical to ``mhcflurry single'' but with  different random initial weights.


% These are generated in the 'paper plots' notebook; do not edit by hand.


\begin{table}[h]
\centering
\begin{tabular}{llll}
\toprule
{} &              AUC &      $F_1$ score & Kendall's $\tau$ \\
\midrule
mhcflurry ensemble &           0.9325 &           0.7847 &  \textbf{0.5865} \\
mhcflurry single   &           0.9313 &           0.7831 &           0.5843 \\
netmhc             &           0.9323 &  \textbf{0.8072} &           0.5863 \\
netmhcpan          &  \textbf{0.9326} &           0.7996 &           0.5814 \\
smmpmbec cpp       &           0.9213 &           0.7903 &           0.5649 \\
\bottomrule
\end{tabular}

\caption{Performance on BLIND with equal weight given to each measurement (53,776 measurements)}
\label{tab:measurementweighted}
\end{table}

\begin{table}[h]
\centering
\begin{tabular}{llll}
\toprule
{} &              AUC &      $F_1$ score & Kendall's $\tau$ \\
\midrule
mhcflurry ensemble &           0.9103 &           0.6635 &           0.4890 \\
mhcflurry single   &           0.9095 &           0.6551 &           0.4874 \\
netmhc             &           0.9091 &           0.6790 &           0.4872 \\
netmhcpan          &  \textbf{0.9115} &  \textbf{0.6902} &  \textbf{0.4927} \\
smmpmbec cpp       &           0.8933 &           0.6555 &           0.4661 \\
\bottomrule
\end{tabular}

\caption{Performance on BLIND with equal weight given to each allele (52 alleles)}
\label{tab:alleleweighted}
\end{table}

\begin{table}[h]
\centering
\begin{tabular}{llll}
\toprule
{} &              AUC &      $F_1$ score & Kendall's $\tau$ \\
\midrule
mhcflurry ensemble &  \textbf{0.9117} &           0.6913 &  \textbf{0.5015} \\
mhcflurry single   &           0.9109 &           0.6873 &           0.4998 \\
netmhc             &           0.9086 &           0.7174 &           0.4984 \\
netmhcpan          &           0.9095 &  \textbf{0.7202} &           0.4994 \\
smmpmbec cpp       &           0.8931 &           0.6964 &           0.4765 \\
\bottomrule
\end{tabular}

\caption{Performance on BLIND for alleles with at least 500 training observations (44 alleles)}
\label{tab:alleleweightedbig}
\end{table}

\begin{table}[h]
\centering
\begin{tabular}{llllllll}
\toprule
allele &        HLA-A2602 &        HLA-A2603 &        HLA-B0803 &        HLA-B1509 &        HLA-B1503 &           H-2-KD &        HLA-B0802 \\
\midrule
train size         &              202 &              205 &              217 &              346 &              429 &              452 &              487 \\
test size          &              413 &              312 &              234 &              466 &              165 &              229 &              509 \\
mhcflurry ensemble &           0.9288 &           0.9096 &           0.9521 &           0.8877 &           0.8388 &           0.7905 &           0.9828 \\
mhcflurry single   &           0.9284 &           0.9062 &           0.9580 &           0.8864 &           0.8354 &           0.7898 &           0.9826 \\
netmhc             &           0.9316 &           0.8902 &           0.9684 &           0.9012 &           0.8648 &           0.8153 &  \textbf{0.9899} \\
netmhcpan          &  \textbf{0.9578} &  \textbf{0.9343} &           0.9523 &  \textbf{0.9229} &  \textbf{0.8701} &  \textbf{0.8192} &           0.9896 \\
smmpmbec cpp       &           0.9430 &           0.8432 &  \textbf{0.9733} &           0.8946 &           0.8394 &           0.7537 &           0.9872 \\
\bottomrule
\end{tabular}

\caption{AUC scores on BLIND dataset for alleles with fewer than 500 training examples}
\label{tab:smallalleles}
\end{table}